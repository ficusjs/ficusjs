const t=Object.freeze({required:t=>`${t} is required`,maxlength:t=>`${t} is too long`,max:(t,e)=>`${t} must be less than or equal to ${e}`,minlength:t=>`${t} is too short`,min:(t,e)=>`${t} must be greater than or equal to ${e}`,pattern:t=>`${t} has a pattern mismatch`,badInput:t=>`${t} has bad input`,stepMismatch:t=>`${t} has a step mismatch`,typeMismatch:t=>`${t} is not in the correct syntax`,unknown:t=>`${t} has an unknown error`});function getFormComponent(t){switch(t.tagName.toLowerCase()){case"input":return t.closest("fc-form-input");case"select":return t.closest("fc-form-select");case"textarea":return t.closest("fc-form-textarea")}}const e={create(e){!function({createComponent:e,renderer:s,html:o}){e("fc-form",{renderer:s,props:{options:{type:Object}},created(){this._touchedElements={},this._customValidators={},this._messages={...t},this.props.options&&this.props.options.messages&&(this._messages={...this._messages,...this.props.options.messages}),this.props.options&&this.props.options.customValidators&&(this._customValidators={...this.props.options.customValidators})},onSubmit(t){t.preventDefault(),t.stopPropagation(),t.target.checkValidity()?this.emitFormEvent(t):this.showErrors(t.target)},showErrors(t){Array.from(t.elements).filter((t=>/input|select|textarea/.test(t.tagName.toLowerCase()))).forEach((t=>{this.setTouched(t),this.showError(t)}))},getFormData(){const t=this.querySelector("form"),e=new FormData(t),s={};for(const t of e.entries())s[t[0]]=t[1];return{formData:e,data:s}},getFormComponents(){const t=this.querySelector("form");return Array.from(t.elements).map((t=>getFormComponent(t)))},getNativeFormElements(){return this.querySelector("form").elements},addCustomValidator(t,e){this._customValidators[t]=e},onReset(t){t.preventDefault(),t.stopPropagation(),this.emitFormEvent(t)},onInput(t){this.handleInputOrChange(t)},onChange(t){this.handleInputOrChange(t)},emitFormEvent(t){const{formData:e,data:s}=this.getFormData(t.target);this.emit(t.type,{form:this,nativeFormElement:t.target,formData:e,data:s,originalEvent:t})},handleInputOrChange(t){t.preventDefault(),t.stopPropagation();const e=t.target;this.setTouched(e),this.showError(e);const s=getFormComponent(e);this.emit(t.type,{component:s,nativeFormElement:e,name:e.getAttribute("name"),value:t.target.value,originalEvent:t})},setTouched(t){const e=t.getAttribute("name");e&&!this._touchedElements[e]&&(this._touchedElements[e]={formInput:t,touched:!0},t.classList.add("ms-is-touched"))},showError(t){const e=getFormComponent(t),s=t.closest(".fc-form-group"),o=s.querySelector(".fc-form-invalid-feedback"),a=s.querySelector(".fc-form-help-text"),clearInputValidation=()=>{t.setCustomValidity(""),o.textContent="",o.classList.remove("fc-form-invalid-feedback--show"),a.style.display="block"},r=e?e.getAttribute("label"):"Input",i=t.getAttribute("name");if(i&&this._customValidators[i]){const e=this._customValidators[i](r,t.value,t);e?(t.setCustomValidity(e),o.textContent=e,o.classList.add("fc-form-invalid-feedback--show"),a.style.display="none"):clearInputValidation()}else t.validity.valid?clearInputValidation():(o.textContent=this.getMessage(t,r),o.classList.add("fc-form-invalid-feedback--show"),a.style.display="none")},getMessage(t,e){return t.validity.valueMissing?this._messages.required(e):t.validity.badInput?this._messages.badInput(e):t.validity.patternMismatch?this._messages.pattern(e):t.validity.rangeOverflow?this._messages.max(e,t.max):t.validity.rangeUnderflow?this._messages.min(e,t.min):t.validity.stepMismatch?this._messages.stepMismatch(e):t.validity.tooLong?this._messages.maxlength(e):t.validity.tooShort?this._messages.minlength(e):t.validity.typeMismatch?this._messages.typeMismatch(e):this._messages.unknown(e)},mounted(){const t=this.querySelector("form");t.addEventListener("submit",this.onSubmit),t.addEventListener("reset",this.onReset),t.addEventListener("input",this.onInput),t.addEventListener("change",this.onChange),this.classList.add("fc-form-container")},render(){return o`<form novalidate>${this.slots.default}</form>`}})}(e)}};export{e as module};
